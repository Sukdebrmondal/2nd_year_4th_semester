CREATE DATABASE SQL_ASSIGNMENT2;
USE SQL_ASSIGNMENT2;

drop database sql_assignment2;

CREATE TABLE STUDENT (
	SID INT PRIMARY KEY,
	SNAME VARCHAR(20),
	SEX VARCHAR(10), 
	AGE INT, 
	YEAR VARCHAR(5), 
	GPA FLOAT 
);

INSERT INTO STUDENT(SID,SNAME,SEX,AGE,YEAR,GPA)
VALUES
-- COMPUTER
(340,'SUKDEB MONDAL','M',20,'2ND',9.3),
(145,'SHEYA MONDAL','F',19,'1ST',7.3),
(261,'RAJKUMAR DAS','M',21,'2ND',8.7),

-- MATH
(257,'MANABI PATRA','M',25,'3RD',9.3),
(232,'BIRSTI MONDAL','F',18,'1ST',7.8),
(358,'SURYA BHOUMIK','M',20,'2ND',8.7),

-- PHY
(212,'ARKA BISWAS','M',21,'2ND',9.2),
(220,'RAJKUMAR BARMAN','M',20,'2ND',8.1),
(254,'SHOUMIK BISOYE','M',23,'D',7.3),
-- ENG
(102,'PRITAM DAS','M',20,'1ST',7.9),
(125,'SHIRSHA BHATTAVHARA','M',22,'2ND',8.6),
(165,'ARGHASHI SAHA','F',24,'3RD',9.2),
 -- cheMISTRY
 (412,'SOHAN DA','M',19,'1ST',7.9),
(414,'RAHUL MONDAL','M',20,'2ND',8.5),
(417,'AMIT GHOSH','M',23,'3RD',7.9);


CREATE TABLE DEPT(
	DNAME VARCHAR(30) PRIMARY KEY,
	NUMPHDS INT
);

INSERT INTO DEPT(DNAME, NUMPHDS)
VALUES
("COMPUTER SCIENCE",12),
("MATHEMATICS",8),
("PHYSICS",6),
("ENGLISH",7),
("CHEMISTRY",10);

CREATE TABLE PROF(
	PNAME VARCHAR(30) PRIMARY KEY, 
	DNAME VARCHAR(30),
    FOREIGN KEY (DNAME) REFERENCES DEPT(DNAME)
);

INSERT INTO PROF(PNAME,DNAME)
VALUES
('SAMARESH M','COMPUTER SCIENCE'),
('SARBAJIT M','COMPUTER SCIENCE'),
('ABHISEKH B','COMPUTER SCIENCE'),

('DEBANJAN M','MATHEMATICS'),
('SAPTARSHI K','MATHEMATICS'),
('SOUGATA M','MATHEMATICS'),

('SWAGATA D','PHYSICS'),
('JOYDIPM','PHYSICS'),
('ARKIT D','PHYSICS'),

('ARCHISMAN D','ENGLISH'),
('TAPASH G','ENGLISH'),

('JURAIN D','CHEMISTRY'),
('UTSAB M','CHEMISTRY');



CREATE TABLE COURSE(
	CNO INT PRIMARY KEY, 
	CNAME VARCHAR(20),
	DNAME VARCHAR(30),
	FOREIGN KEY (DNAME) REFERENCES DEPT(DNAME)
);

INSERT INTO COURSE(CNO,CNAME,DNAME)
VALUES
(101,"ML","COMPUTER SCIENCE"),
(102,"DL","COMPUTER SCIENCE"),
(103,"DBMS","COMPUTER SCIENCE"),

(201,"REAL ANALYSIS","MATHEMATICS"),
(202,"GRAPH THEORY","MATHEMATICS"),
(203,"GROUP THEORY","MATHEMATICS"),

(301,"OPTICS","PHYSICS"),
(302,"GEOPHYSICS","PHYSICS"),
(303,"HARMONIK","PHYSICS"),

(401,"THE MIDNIGHT EXPRESS","ENGLISH"),
(402,"THE EYES HAVE IT","ENGLISH"),
(403,"THE BLUE UMBRELLA","ENGLISH"),

(501,"ORIGANIK CHEMISTEY","CHEMISTRY"),
(502,"PHYSICAL CHEMISTRY","CHEMISTRY"),
(503,"BONDING STRUCTURE","CHEMISTRY");

CREATE TABLE MAJOR(
	 DNAME VARCHAR(30),
	 SID INT,
	FOREIGN KEY (SID) REFERENCES STUDENT(SID),
	FOREIGN KEY (DNAME) REFERENCES DEPT(DNAME)
);

INSERT INTO MAJOR(DNAME, SID)
VALUES
('COMPUTER SCIENCE', 340),
('COMPUTER SCIENCE', 145),
('COMPUTER SCIENCE', 261),
('MATHEMATICS', 257),
('MATHEMATICS', 232),
('MATHEMATICS', 358),
('PHYSICS', 212),
('PHYSICS', 220),
('PHYSICS', 254),
('ENGLISH', 102),
('ENGLISH', 125),
('ENGLISH', 165),
('CHEMISTRY', 412),
('CHEMISTRY', 414),
('CHEMISTRY', 417);




CREATE TABLE SECTION(
	DNAME VARCHAR(30), 
	CNO INT, 
	SECTNO INT PRIMARY KEY, 
	PNAME VARCHAR(30),
    FOREIGN KEY (DNAME) REFERENCES DEPT(DNAME),
    FOREIGN KEY (CNO) REFERENCES COURSE(CNO),
    FOREIGN KEY (PNAME) REFERENCES PROF(PNAME)
);

INSERT INTO SECTION(DNAME, CNO, SECTNO, PNAME)
VALUES
('COMPUTER SCIENCE', 101, 1, 'SAMARESH M'),
('COMPUTER SCIENCE', 102, 2, 'SARBAJIT M'),
('COMPUTER SCIENCE', 103, 3, 'ABHISEKH B'),

('MATHEMATICS', 201, 4, 'DEBANJAN M'),
('MATHEMATICS', 202, 5, 'SAPTARSHI K'),
('MATHEMATICS', 203, 6, 'SOUGATA M'),

('PHYSICS', 301, 7, 'SWAGATA D'),
('PHYSICS', 302, 8, 'JOYDIPM'),
('PHYSICS', 303, 9, 'ARKIT D'),

('ENGLISH', 401, 10, 'ARCHISMAN D'),
('ENGLISH', 402, 11, 'TAPASH G'),
('ENGLISH', 403, 12, 'ARCHISMAN D'),

('CHEMISTRY', 501, 13, 'JURAIN D'),
('CHEMISTRY', 502, 14, 'UTSAB M'),
('CHEMISTRY', 503, 15, 'JURAIN D');




CREATE TABLE ENROLL(
SID INT, 
GRADE VARCHAR(4), 
DNAME VARCHAR(30), 
CNO INT , 
SECTNO INT,
FOREIGN KEY (SID) REFERENCES STUDENT(SID),
FOREIGN KEY (DNAME) REFERENCES DEPT(DNAME),
FOREIGN KEY (CNO) REFERENCES COURSE(CNO),
FOREIGN KEY (SECTNO) REFERENCES SECTION(SECTNO)
);

INSERT INTO ENROLL(SID, GRADE, DNAME, CNO, SECTNO)
VALUES
(340, 'A', 'COMPUTER SCIENCE', 101, 1),
(340, 'A', 'COMPUTER SCIENCE', 102, 2),
(340, 'A', 'MATHEMATICS', 201, 4),
(145, 'B', 'COMPUTER SCIENCE', 103, 3),
(145, 'B', 'MATHEMATICS', 202, 5),
(261, 'A', 'COMPUTER SCIENCE', 101, 1),
(261, 'B', 'PHYSICS', 301, 7),
(257, 'A', 'MATHEMATICS', 201, 4),
(232, 'A', 'MATHEMATICS', 202, 5),
(358, 'B', 'MATHEMATICS', 203, 6),
(212, 'A', 'PHYSICS', 302, 8),
(220, 'B', 'PHYSICS', 303, 9),
(254, 'A', 'PHYSICS', 301, 7),
(102, 'A', 'ENGLISH', 401, 10),
(125, 'A', 'ENGLISH', 402, 11),
(165, 'A', 'ENGLISH', 403, 12),
(412, 'A', 'CHEMISTRY', 501, 13),
(414, 'B', 'CHEMISTRY', 502, 14),
(417, 'C', 'CHEMISTRY', 503, 15);

select * from student;
select * from dept;
select * from prof;
select * from course;
select * from major;
select * from section;
select * from enroll;
-- 1

SELECT P.PNAME
FROM PROF P
JOIN DEPT D ON P.DNAME = D.DNAME
WHERE D.NUMPHDS < 20;

-- 2

SELECT SNAME
FROM STUDENT
WHERE GPA = (SELECT MIN(GPA) FROM STUDENT);


-- 3

SELECT S.SID, S.SNAME
FROM STUDENT S
JOIN ENROLL E ON S.SID = E.SID
GROUP BY S.SID, S.SNAME
ORDER BY COUNT(*) DESC
LIMIT 1;

-- 4
SELECT S.SNAME, M.DNAME
FROM STUDENT S
JOIN MAJOR M ON S.SID = M.SID
WHERE S.SID = 340;

-- 5

SELECT S.SNAME
FROM STUDENT S
WHERE S.SID IN (
    SELECT E1.SID
    FROM ENROLL E1
    JOIN ENROLL E2 ON E1.SID = E2.SID
    WHERE E1.DNAME = 'COMPUTER SCIENCE'
      AND E2.DNAME = 'MATHEMATICS'
);
 
